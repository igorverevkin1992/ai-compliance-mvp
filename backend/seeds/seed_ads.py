import os
from sqlalchemy import create_engine, text
import uuid

# –í—Å—Ç–∞–≤—å —Å–≤–æ—é —Å—Å—ã–ª–∫—É Supabase
DATABASE_URL = os.getenv("DATABASE_URL")
engine = create_engine(DATABASE_URL)

def seed_fz_38_ad_law():
    with engine.connect() as conn:
        print("üì£ –ó–∞–≥—Ä—É–∑–∫–∞ –§–ó-38 (–û —Ä–µ–∫–ª–∞–º–µ) –≤ –±–∞–∑—É...")
        
        # 1. –°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç
        # 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –≤ Python
        doc_id = uuid.uuid4()
        
        # 2. –ü–µ—Ä–µ–¥–∞–µ–º –µ–≥–æ –≤ –∑–∞–ø—Ä–æ—Å
        conn.execute(text("""
            INSERT INTO legal_doc (id, publisher, title, version) 
            VALUES (:id, '–†–§', '–ù–∞–∑–≤–∞–Ω–∏–µ...', '–≤–µ—Ä—Å–∏—è...')
        """), {"id": doc_id})
        
        requirements = [
            {
                "code": "RF_AD_GENERAL_BAD",
                "type": "PROHIBITED",
                "risk": "MEDIUM",
                "summary": "–ù–µ–¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–∞—è –∏ –Ω–µ–¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–∞.",
                "text": "–°—Ç–∞—Ç—å—è 5, —á.1: –†–µ–∫–ª–∞–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω–æ–π –∏ –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ–π. –ù–µ –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è, –ø–æ—Ä–æ—á–∞—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –ª–æ–∂–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ —Ç–æ–≤–∞—Ä–µ/—É—Å–ª—É–≥–µ."
            },
            {
                "code": "RF_AD_ILLEGAL_CONTENT",
                "type": "PROHIBITED",
                "risk": "CRITICAL",
                "summary": "–ó–∞–ø—Ä–µ—Ç –Ω–∞ —Ä–µ–∫–ª–∞–º—É –ø—Ä–æ—Ç–∏–≤–æ–ø—Ä–∞–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π, –Ω–∞—Å–∏–ª–∏—è, –ø–æ—Ä–Ω–æ–≥—Ä–∞—Ñ–∏–∏, –õ–ì–ë–¢.",
                "text": "–°—Ç–∞—Ç—å—è 5, —á.4: –†–µ–∫–ª–∞–º–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞: –ø–æ–±—É–∂–¥–∞—Ç—å –∫ –ø—Ä–æ—Ç–∏–≤–æ–ø—Ä–∞–≤–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏—è–º, –ø—Ä–∏–∑—ã–≤–∞—Ç—å –∫ –Ω–∞—Å–∏–ª–∏—é/–∂–µ—Å—Ç–æ–∫–æ—Å—Ç–∏, —É–≥—Ä–æ–∂–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏—è, —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –ª–∏—Ü–∞–º, —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ—Ä–Ω–æ–≥—Ä–∞—Ñ–∏—é, –ø—Ä–æ–ø–∞–≥–∞–Ω–¥–∏—Ä–æ–≤–∞—Ç—å –õ–ì–ë–¢/—Å–º–µ–Ω—É –ø–æ–ª–∞/–æ—Ç–∫–∞–∑ –æ—Ç –¥–µ—Ç–æ—Ä–æ–∂–¥–µ–Ω–∏—è."
            },
            {
                "code": "RF_AD_CHILDREN_PROTECTION",
                "type": "PROHIBITED",
                "risk": "HIGH",
                "summary": "–ó–∞—â–∏—Ç–∞ –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏—Ö –≤ —Ä–µ–∫–ª–∞–º–µ (–¥–∏—Å–∫—Ä–µ–¥–∏—Ç–∞—Ü–∏—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π, –ø–æ–±—É–∂–¥–µ–Ω–∏–µ –∫ –ø–æ–∫—É–ø–∫–µ).",
                "text": "–°—Ç–∞—Ç—å—è 6: –í —Ä–µ–∫–ª–∞–º–µ –Ω–µ –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è: –¥–∏—Å–∫—Ä–µ–¥–∏—Ç–∞—Ü–∏—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π, –ø–æ–±—É–∂–¥–µ–Ω–∏–µ –¥–µ—Ç–µ–π –ø—Ä–æ—Å–∏—Ç—å –∫—É–ø–∏—Ç—å —Ç–æ–≤–∞—Ä, —Å–æ–∑–¥–∞–Ω–∏–µ –ª–æ–∂–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞, —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–∞ –Ω–µ–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ—Å—Ç–∏, –ø–æ–∫–∞–∑ –¥–µ—Ç–µ–π –≤ –æ–ø–∞—Å–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö."
            },
            {
                "code": "RF_AD_FORBIDDEN_GOODS",
                "type": "PROHIBITED",
                "risk": "CRITICAL",
                "summary": "–ó–∞–ø—Ä–µ—Ç —Ä–µ–∫–ª–∞–º—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤/—É—Å–ª—É–≥ (–Ω–∞—Ä–∫–æ—Ç–∏–∫–∏, –æ—Ä—É–∂–∏–µ, —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–∏—Ä–∞–º–∏–¥—ã).",
                "text": "–°—Ç–∞—Ç—å—è 7: –ù–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Ä–µ–∫–ª–∞–º–∞ —Ç–æ–≤–∞—Ä–æ–≤/—É—Å–ª—É–≥: –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–ø—Ä–µ—â–µ–Ω–æ; –Ω–∞—Ä–∫–æ—Ç–∏–∫–æ–≤, –≤–∑—Ä—ã–≤—á–∞—Ç—ã—Ö –≤–µ—â–µ—Å—Ç–≤, –æ—Ä–≥–∞–Ω–æ–≤ —á–µ–ª–æ–≤–µ–∫–∞, —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–∏—Ä–∞–º–∏–¥, —É—Å–ª—É–≥ –ø–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—é –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏–π."
            },
            {
                "code": "RF_AD_TOBACCO_ALCO_BAN",
                "type": "PROHIBITED",
                "risk": "CRITICAL",
                "summary": "–ó–∞–ø—Ä–µ—Ç —Ä–µ–∫–ª–∞–º—ã —Ç–∞–±–∞–∫–∞ –∏ –∞–ª–∫–æ–≥–æ–ª—è.",
                "text": "–°—Ç–∞—Ç—å—è 7, –ø.8 –∏ –°—Ç–∞—Ç—å—è 21: –ó–∞–ø—Ä–µ—â–∞–µ—Ç—Å—è —Ä–µ–∫–ª–∞–º–∞ —Ç–∞–±–∞—á–Ω—ã—Ö –∏–∑–¥–µ–ª–∏–π, –Ω–∏–∫–æ—Ç–∏–Ω—Å–æ–¥–µ—Ä–∂–∞—â–µ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏, –∞–ª–∫–æ–≥–æ–ª—å–Ω–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏ (–≤ —Ç.—á. –ø–∏–≤–∞). –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: –≤–∏–Ω–æ –∏ —à–∞–º–ø–∞–Ω—Å–∫–æ–µ –Ω–∞ –≤—ã—Å—Ç–∞–≤–∫–∞—Ö, –ø–∏–≤–æ –Ω–∞ —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö."
            },
            {
                "code": "RF_AD_FINANCIAL_SERVICES",
                "type": "MANDATORY",
                "risk": "HIGH",
                "summary": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ–∫–ª–∞–º–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —É—Å–ª—É–≥ (–¥–∏—Å–∫–ª–µ–π–º–µ—Ä—ã, –ø–æ–ª–Ω—ã–µ —É—Å–ª–æ–≤–∏—è).",
                "text": "–°—Ç–∞—Ç—å—è 28: –†–µ–∫–ª–∞–º–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —É—Å–ª—É–≥ (–∫—Ä–µ–¥–∏—Ç—ã, –∑–∞–π–º—ã, –∏–ø–æ—Ç–µ–∫–∞) –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ—Ä–∞, –∞ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ–± —É—Å–ª–æ–≤–∏—è—Ö –∏ —Ä–∏—Å–∫–∞—Ö. (–ü—Ä–∏–º–µ—Ä: '–ò–∑—É—á–∏—Ç–µ –≤—Å–µ —É—Å–ª–æ–≤–∏—è –∫—Ä–µ–¥–∏—Ç–∞ –Ω–∞ —Å–∞–π—Ç–µ')."
            },
            {
                "code": "RF_AD_DISCLAIMER_REQUIRED",
                "type": "MANDATORY",
                "risk": "MEDIUM",
                "summary": "–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –¥–∏—Å–∫–ª–µ–π–º–µ—Ä –ø—Ä–∏ —Ä–µ–∫–ª–∞–º–µ –ª–µ–∫–∞—Ä—Å—Ç–≤ –∏ –ë–ê–î–æ–≤.",
                "text": "–°—Ç–∞—Ç—å—è 24 —á.7, –°—Ç–∞—Ç—å—è 25 —á.11: –†–µ–∫–ª–∞–º–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤ –∏ –ë–ê–î–æ–≤ –¥–æ–ª–∂–Ω–∞ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞—Ç—å—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º –æ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è—Ö ('–ï—Å—Ç—å –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è, –ø—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Ç–µ—Å—å —Å –≤—Ä–∞—á–æ–º')."
            },
            {
                "code": "RF_AD_HIDDEN_AD",
                "type": "PROHIBITED",
                "risk": "CRITICAL",
                "summary": "–ó–∞–ø—Ä–µ—Ç –Ω–∞ —Å–∫—Ä—ã—Ç—É—é —Ä–µ–∫–ª–∞–º—É (–Ω–µ–Ω–∞–º–µ—Ä–µ–Ω–Ω–æ–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ).",
                "text": "–°—Ç–∞—Ç—å—è 9: –ù–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –º–µ–¥–∏–∞–ø—Ä–æ–¥—É–∫—Ü–∏–∏ —Å–∫—Ä—ã—Ç–æ–π —Ä–µ–∫–ª–∞–º—ã, –æ–∫–∞–∑—ã–≤–∞—é—â–µ–π –Ω–µ–æ—Å–æ–∑–Ω–∞–≤–∞–µ–º–æ–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, 25-–π –∫–∞–¥—Ä, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∑–≤—É–∫–æ–∑–∞–ø–∏—Å—å)."
            }
        ]
        
        for req in requirements:
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –¥–ª—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
            req_id = uuid.uuid4()

            conn.execute(text("""
                INSERT INTO legal_requirement (id, doc_id, req_code, requirement_type, risk_floor, summary, full_text)
                VALUES (:id, :doc_id, :code, :type, :risk, :summ, :text)
                ON CONFLICT (req_code) DO UPDATE SET full_text = EXCLUDED.full_text
            """), {
                "id": req_id,       # <--- –î–û–ë–ê–í–õ–ï–ù–û
                "doc_id": doc_id,
                "code": req["code"],
                "type": req["type"],
                "risk": req["risk"],
                "summ": req["summary"],
                "text": req["text"]
            })
        
        conn.commit()
        print("‚úÖ –§–ó-38 (–û —Ä–µ–∫–ª–∞–º–µ) —É—Å–ø–µ—à–Ω–æ –æ—Ü–∏—Ñ—Ä–æ–≤–∞–Ω. –ê–≥–µ–Ω—Ç —Å—Ç–∞–ª —ç–∫—Å–ø–µ—Ä—Ç–æ–º –ø–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É.")

if __name__ == "__main__":
    seed_fz_38_ad_law()