import os
from sqlalchemy import create_engine, text
import uuid

# –í—Å—Ç–∞–≤—å —Å–≤–æ—é —Å—Å—ã–ª–∫—É Supabase
DATABASE_URL = os.getenv("DATABASE_URL")
engine = create_engine(DATABASE_URL)

def seed_436_law():
    with engine.connect() as conn:
        print("üìñ –ó–∞–≥—Ä—É–∑–∫–∞ –§–ó-436 (–ó–∞—â–∏—Ç–∞ –¥–µ—Ç–µ–π) –≤ –±–∞–∑—É...")
        
        # 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –≤ Python
        doc_id = uuid.uuid4()
        
        # 2. –ü–µ—Ä–µ–¥–∞–µ–º –µ–≥–æ –≤ –∑–∞–ø—Ä–æ—Å
        conn.execute(text("""
            INSERT INTO legal_doc (id, publisher, title, version) 
            VALUES (:id, '–†–§', '–ù–∞–∑–≤–∞–Ω–∏–µ...', '–≤–µ—Ä—Å–∏—è...')
        """), {"id": doc_id})
        
        requirements = [
            {
                "code": "RF_436_PROHIBITED_GEN",
                "type": "PROHIBITED",
                "risk": "CRITICAL",
                "summary": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–ø—Ä–µ—â–µ–Ω–Ω–∞—è –¥–ª—è –¥–µ—Ç–µ–π (–Ω–∞—Ä–∫–æ—Ç–∏–∫–∏, —Å—É–∏—Ü–∏–¥, –Ω–∞—Å–∏–ª–∏–µ).",
                "text": "–°—Ç–∞—Ç—å—è 5, —á.2: –ó–∞–ø—Ä–µ—â–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: –ø–æ–±—É–∂–¥–∞—é—â–∞—è –∫ –¥–µ–π—Å—Ç–≤–∏—è–º, —É–≥—Ä–æ–∂–∞—é—â–∏–º –∂–∏–∑–Ω–∏ (—Å—É–∏—Ü–∏–¥); —Å–ø–æ—Å–æ–±–Ω–∞—è –≤—ã–∑–≤–∞—Ç—å –∂–µ–ª–∞–Ω–∏–µ —É–ø–æ—Ç—Ä–µ–±–∏—Ç—å –Ω–∞—Ä–∫–æ—Ç–∏–∫–∏/–∞–ª–∫–æ–≥–æ–ª—å; –æ–ø—Ä–∞–≤–¥—ã–≤–∞—é—â–∞—è –Ω–∞—Å–∏–ª–∏–µ –∏ –∂–µ—Å—Ç–æ–∫–æ—Å—Ç—å; —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –Ω–µ—Ü–µ–Ω–∑—É—Ä–Ω—É—é –±—Ä–∞–Ω—å; –ø–æ—Ä–Ω–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞."
            },
            {
                "code": "RF_436_FAMILY_VALUES",
                "type": "PROHIBITED",
                "risk": "CRITICAL",
                "summary": "–û—Ç—Ä–∏—Ü–∞–Ω–∏–µ —Å–µ–º–µ–π–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π –∏ –õ–ì–ë–¢-–ø—Ä–æ–ø–∞–≥–∞–Ω–¥–∞.",
                "text": "–°—Ç–∞—Ç—å—è 5, —á.2, –ø.4: –ó–∞–ø—Ä–µ—â–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –æ—Ç—Ä–∏—Ü–∞—é—â–∞—è —Å–µ–º–µ–π–Ω—ã–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏, –ø—Ä–æ–ø–∞–≥–∞–Ω–¥–∏—Ä—É—é—â–∞—è –Ω–µ—Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Å–µ–∫—Å—É–∞–ª—å–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∏ —Ñ–æ—Ä–º–∏—Ä—É—é—â–∞—è –Ω–µ—É–≤–∞–∂–µ–Ω–∏–µ –∫ —Ä–æ–¥–∏—Ç–µ–ª—è–º."
            },
            {
                "code": "RF_436_LABELING",
                "type": "MANDATORY",
                "risk": "HIGH",
                "summary": "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –≤–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ (–∑–Ω–∞–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏).",
                "text": "–°—Ç–∞—Ç—å—è 12: –û–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ (0+, 6+, 12+, 16+, 18+) –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω–æ –≤ –Ω–∞—á–∞–ª–µ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏ –∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏. –†–∞–∑–º–µ—Ä –∑–Ω–∞–∫–∞ - –Ω–µ –º–µ–Ω–µ–µ 5% –ø–ª–æ—â–∞–¥–∏ –∫–∞–¥—Ä–∞."
            },
            {
                "code": "RF_436_SWEARING_16",
                "type": "RESTRICTED",
                "risk": "MEDIUM",
                "summary": "–ë—Ä–∞–Ω–Ω—ã–µ —Å–ª–æ–≤–∞ (–Ω–µ –º–∞—Ç) –¥–æ–ø—É—Å—Ç–∏–º—ã —Ç–æ–ª—å–∫–æ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ 16+.",
                "text": "–°—Ç–∞—Ç—å—è 10, –ø.4: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –¥–µ—Ç–µ–π —Å—Ç–∞—Ä—à–µ 16 –ª–µ—Ç –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –±—Ä–∞–Ω–Ω—ã–µ —Å–ª–æ–≤–∞ –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è, –Ω–µ –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ –Ω–µ—Ü–µ–Ω–∑—É—Ä–Ω–æ–π –±—Ä–∞–Ω–∏."
            },
            {
                "code": "RF_436_CRUELTY_16",
                "type": "RESTRICTED",
                "risk": "MEDIUM",
                "summary": "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞—Å–∏–ª–∏—è –¥–æ–ø—É—Å—Ç–∏–º–æ –≤ 16+ –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏ —Å–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏—è –∫ –∂–µ—Ä—Ç–≤–µ.",
                "text": "–°—Ç–∞—Ç—å—è 10, –ø.2: –î–ª—è 16+ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∂–µ—Å—Ç–æ–∫–æ—Å—Ç–∏ –∏ –Ω–∞—Å–∏–ª–∏—è (–∫—Ä–æ–º–µ —Å–µ–∫—Å—É–∞–ª—å–Ω–æ–≥–æ) –±–µ–∑ –Ω–∞—Ç—É—Ä–∞–ª–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∫–∞–∑–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ —É–±–∏–π—Å—Ç–≤–∞, –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è —Å–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏—è –∫ –∂–µ—Ä—Ç–≤–µ –∏ –æ—Å—É–∂–¥–µ–Ω–∏—è –Ω–∞—Å–∏–ª–∏—è."
            }
        ]
        
        for req in requirements:
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –¥–ª—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
            req_id = uuid.uuid4()

            conn.execute(text("""
                INSERT INTO legal_requirement (id, doc_id, req_code, requirement_type, risk_floor, summary, full_text)
                VALUES (:id, :doc_id, :code, :type, :risk, :summ, :text)
                ON CONFLICT (req_code) DO UPDATE SET full_text = EXCLUDED.full_text
            """), {
                "id": req_id,       # <--- –î–û–ë–ê–í–õ–ï–ù–û
                "doc_id": doc_id,
                "code": req["code"],
                "type": req["type"],
                "risk": req["risk"],
                "summ": req["summary"],
                "text": req["text"]
            })
        
        conn.commit()
        print("‚úÖ –§–ó-436 —É—Å–ø–µ—à–Ω–æ –æ—Ü–∏—Ñ—Ä–æ–≤–∞–Ω –∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–∞–∑—É –∑–Ω–∞–Ω–∏–π.")

if __name__ == "__main__":
    seed_436_law()