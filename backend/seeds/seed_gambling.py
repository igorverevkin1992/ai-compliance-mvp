import os
from sqlalchemy import create_engine, text
import uuid

# –í—Å—Ç–∞–≤—å —Å—Å—ã–ª–∫—É Supabase
DATABASE_URL = os.getenv("DATABASE_URL")
engine = create_engine(DATABASE_URL)

def seed_gambling_law():
    with engine.connect() as conn:
        print("üé∞ –ó–∞–≥—Ä—É–∑–∫–∞ –§–ó-244 (–ê–∑–∞—Ä—Ç–Ω—ã–µ –∏–≥—Ä—ã) –≤ –±–∞–∑—É...")
        
        # 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –≤ Python
        doc_id = uuid.uuid4()
        
        # 2. –ü–µ—Ä–µ–¥–∞–µ–º –µ–≥–æ –≤ –∑–∞–ø—Ä–æ—Å
        conn.execute(text("""
            INSERT INTO legal_doc (id, publisher, title, version) 
            VALUES (:id, '–†–§', '–ù–∞–∑–≤–∞–Ω–∏–µ...', '–≤–µ—Ä—Å–∏—è...')
        """), {"id": doc_id})
        
        requirements = [
            {
                "code": "RF_GAMBLING_ONLINE_CASINO",
                "type": "PROHIBITED",
                "risk": "CRITICAL",
                "summary": "–ü–æ–ª–Ω—ã–π –∑–∞–ø—Ä–µ—Ç –æ–Ω–ª–∞–π–Ω-–∫–∞–∑–∏–Ω–æ –∏ –∏–≥—Ä–æ–≤—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–æ–≤ –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–µ.",
                "text": "–°—Ç–∞—Ç—å—è 5 —á.3: –î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—é –∞–∑–∞—Ä—Ç–Ω—ã—Ö –∏–≥—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ-—Ç–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π (–≤ —Ç–æ–º —á–∏—Å–ª–µ —Å–µ—Ç–∏ '–ò–Ω—Ç–µ—Ä–Ω–µ—Ç') –ó–ê–ü–†–ï–©–ï–ù–ê. –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ –≤ –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±—É–∫–º–µ–∫–µ—Ä—Å–∫–∏—Ö –∫–æ–Ω—Ç–æ—Ä–∞—Ö."
            },
            {
                "code": "RF_GAMBLING_BOOKMAKERS_LEGAL",
                "type": "PERMITTED",
                "risk": "MEDIUM",
                "summary": "–õ–µ–≥–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –±—É–∫–º–µ–∫–µ—Ä—Å–∫–∏—Ö –∫–æ–Ω—Ç–æ—Ä (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ª–∏—Ü–µ–Ω–∑–∏–∏).",
                "text": "–°—Ç–∞—Ç—å—è 14: –î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±—É–∫–º–µ–∫–µ—Ä—Å–∫–∏—Ö –∫–æ–Ω—Ç–æ—Ä –∏ —Ç–æ—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –ª–∏—Ü–µ–Ω–∑–∏–∏ –§–ù–°. –ü—Ä–∏–µ–º –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç–∞–≤–æ–∫ (–æ–Ω–ª–∞–π–Ω) —Ä–∞–∑—Ä–µ—à–µ–Ω —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –ï–¥–∏–Ω—ã–π —Ü–µ–Ω—Ç—Ä —É—á–µ—Ç–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (–ï–¶–£–ü–°/–ï–†–ê–ò). –†–µ–∫–ª–∞–º–∞ –Ω–µ–ª–µ–≥–∞–ª—å–Ω—ã—Ö –±—É–∫–º–µ–∫–µ—Ä–æ–≤ (–±–µ–∑ –ª–∏—Ü–µ–Ω–∑–∏–∏ –†–§) –∑–∞–ø—Ä–µ—â–µ–Ω–∞."
            },
            {
                "code": "RF_GAMBLING_MINORS_BAN",
                "type": "PROHIBITED",
                "risk": "CRITICAL",
                "summary": "–°—Ç—Ä–æ–≥–∏–π –∑–∞–ø—Ä–µ—Ç –Ω–∞ —É—á–∞—Å—Ç–∏–µ –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏—Ö (18+).",
                "text": "–°—Ç–∞—Ç—å—è 7 —á.2: –ü–æ—Å–µ—Ç–∏—Ç–µ–ª—è–º–∏ –∏–≥–æ—Ä–Ω–æ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏—è –∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –∞–∑–∞—Ä—Ç–Ω—ã—Ö –∏–≥—Ä –Ω–µ –º–æ–≥—É—Ç —è–≤–ª—è—Ç—å—Å—è –ª–∏—Ü–∞, –Ω–µ –¥–æ—Å—Ç–∏–≥—à–∏–µ –≤–æ–∑—Ä–∞—Å—Ç–∞ 18 –ª–µ—Ç. –í–æ–≤–ª–µ—á–µ–Ω–∏–µ –¥–µ—Ç–µ–π –≤ –∞–∑–∞—Ä—Ç–Ω—ã–µ –∏–≥—Ä—ã –∑–∞–ø—Ä–µ—â–µ–Ω–æ."
            },
             {
                "code": "RF_GAMBLING_ILLEGAL_PAYMENTS",
                "type": "PROHIBITED",
                "risk": "HIGH",
                "summary": "–ó–∞–ø—Ä–µ—Ç –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –Ω–µ–ª–µ–≥–∞–ª—å–Ω—ã–º –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞–º.",
                "text": "–°—Ç–∞—Ç—å—è 5.1: –ö—Ä–µ–¥–∏—Ç–Ω—ã–º –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º –∑–∞–ø—Ä–µ—â–µ–Ω–æ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –¥–µ–Ω–µ–∂–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –≤ –ø–æ–ª—å–∑—É –ª–∏—Ü, –≤–∫–ª—é—á–µ–Ω–Ω—ã—Ö –≤ –ø–µ—Ä–µ—á–µ–Ω—å –Ω–µ–ª–µ–≥–∞–ª—å–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–æ–≤ –∞–∑–∞—Ä—Ç–Ω—ã—Ö –∏–≥—Ä. –†–µ–∫–ª–∞–º–∞ —Å–ø–æ—Å–æ–±–æ–≤ –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –¥–ª—è –æ–ø–ª–∞—Ç—ã –≤ –∫–∞–∑–∏–Ω–æ —è–≤–ª—è–µ—Ç—Å—è –Ω–∞—Ä—É—à–µ–Ω–∏–µ–º."
            }
        ]
        
        for req in requirements:
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –¥–ª—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
            req_id = uuid.uuid4()

            conn.execute(text("""
                INSERT INTO legal_requirement (id, doc_id, req_code, requirement_type, risk_floor, summary, full_text)
                VALUES (:id, :doc_id, :code, :type, :risk, :summ, :text)
                ON CONFLICT (req_code) DO UPDATE SET full_text = EXCLUDED.full_text
            """), {
                "id": req_id,       # <--- –î–û–ë–ê–í–õ–ï–ù–û
                "doc_id": doc_id,
                "code": req["code"],
                "type": req["type"],
                "risk": req["risk"],
                "summ": req["summary"],
                "text": req["text"]
            })
        
        conn.commit()
        print("‚úÖ –§–ó-244 (–ê–∑–∞—Ä—Ç–Ω—ã–µ –∏–≥—Ä—ã) —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω.")

if __name__ == "__main__":
    seed_gambling_law()