import os
from sqlalchemy import create_engine, text
import uuid

# –í—Å—Ç–∞–≤—å —Å–≤–æ—é —Å—Å—ã–ª–∫—É Supabase
DATABASE_URL = os.getenv("DATABASE_URL")
engine = create_engine(DATABASE_URL)

def seed_149_law():
    with engine.connect() as conn:
        print("üåê –ó–∞–≥—Ä—É–∑–∫–∞ –§–ó-149 (–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –∏ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏) –≤ –±–∞–∑—É...")
        
        # 1. –°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç
        # 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –≤ Python
        doc_id = uuid.uuid4()
        
        # 2. –ü–µ—Ä–µ–¥–∞–µ–º –µ–≥–æ –≤ –∑–∞–ø—Ä–æ—Å
        conn.execute(text("""
            INSERT INTO legal_doc (id, publisher, title, version) 
            VALUES (:id, '–†–§', '–ù–∞–∑–≤–∞–Ω–∏–µ...', '–≤–µ—Ä—Å–∏—è...')
        """), {"id": doc_id})
        
        requirements = [
            {
                "code": "RF_149_BANNED_CONTENT",
                "type": "PROHIBITED",
                "risk": "CRITICAL",
                "summary": "–ï–¥–∏–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä –∑–∞–ø—Ä–µ—â–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–æ—Å–Ω–æ–≤–∞–Ω–∏—è –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏).",
                "text": "–°—Ç–∞—Ç—å—è 15.1: –í —Ä–µ–µ—Å—Ç—Ä –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö —Å–∞–π—Ç–æ–≤ –≤–∫–ª—é—á–∞—é—Ç—Å—è —Ä–µ—Å—É—Ä—Å—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ: –¥–µ—Ç—Å–∫—É—é –ø–æ—Ä–Ω–æ–≥—Ä–∞—Ñ–∏—é; –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–ø–æ—Å–æ–±–∞—Ö –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è/—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –Ω–∞—Ä–∫–æ—Ç–∏–∫–æ–≤; –ø—Ä–∏–∑—ã–≤—ã –∫ —Å—É–∏—Ü–∏–¥—É; –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏—Ö, –ø–æ—Å—Ç—Ä–∞–¥–∞–≤—à–∏—Ö –æ—Ç –ø—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–π; –∞–∑–∞—Ä—Ç–Ω—ã–µ –∏–≥—Ä—ã."
            },
            {
                "code": "RF_149_EXTREMISM_BLOCK",
                "type": "PROHIBITED",
                "risk": "CRITICAL",
                "summary": "–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞ —ç–∫—Å—Ç—Ä–µ–º–∏–∑–º –∏ –ø—Ä–∏–∑—ã–≤—ã –∫ –±–µ—Å–ø–æ—Ä—è–¥–∫–∞–º.",
                "text": "–°—Ç–∞—Ç—å—è 15.3: –ì–µ–Ω–ø—Ä–æ–∫—É—Ä–æ—Ä –†–§ —Ç—Ä–µ–±—É–µ—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –ø—Ä–∏–∑—ã–≤—ã –∫ –º–∞—Å—Å–æ–≤—ã–º –±–µ—Å–ø–æ—Ä—è–¥–∫–∞–º, —ç–∫—Å—Ç—Ä–µ–º–∏–∑–º—É, —É—á–∞—Å—Ç–∏—é –≤ –Ω–µ–∑–∞–∫–æ–Ω–Ω—ã—Ö –∞–∫—Ü–∏—è—Ö, –∞ —Ç–∞–∫–∂–µ –Ω–µ–¥–æ—Å—Ç–æ–≤–µ—Ä–Ω—É—é –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –∑–Ω–∞—á–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (—Ñ–µ–π–∫–∏), —Å–æ–∑–¥–∞—é—â—É—é —É–≥—Ä–æ–∑—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏."
            },
            {
                "code": "RF_149_SOCIAL_NET_DUTIES",
                "type": "MANDATORY",
                "risk": "HIGH",
                "summary": "–û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ —Å–æ—Ü—Å–µ—Ç–µ–π (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–¥–∞–ª–µ–Ω–∏–µ).",
                "text": "–°—Ç–∞—Ç—å—è 10.6: –í–ª–∞–¥–µ–ª–µ—Ü —Å–æ—Ü—Å–µ—Ç–∏ (—Ä–µ—Å—É—Ä—Å–∞ —Å >500–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) –æ–±—è–∑–∞–Ω —Å–∞–º –≤—ã—è–≤–ª—è—Ç—å –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç: –ø–æ—Ä–Ω–æ–≥—Ä–∞—Ñ–∏—é, –Ω–∞—Ä–∫–æ—Ç–∏–∫–∏, —Å—É–∏—Ü–∏–¥, –∞–∑–∞—Ä—Ç–Ω—ã–µ –∏–≥—Ä—ã, –ø—Ä–∏–∑—ã–≤—ã –∫ —ç–∫—Å—Ç—Ä–µ–º–∏–∑–º—É, –º–∞—Ç (–Ω–µ—Ü–µ–Ω–∑—É—Ä–Ω—É—é –±—Ä–∞–Ω—å), –ø–æ—Ä–æ—á–∞—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é."
            },
            {
                "code": "RF_149_NEWS_AGGREGATOR",
                "type": "MANDATORY",
                "risk": "HIGH",
                "summary": "–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –Ω–æ–≤–æ—Å—Ç–Ω—ã—Ö –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä–æ–≤ –∑–∞ —Ñ–µ–π–∫–∏.",
                "text": "–°—Ç–∞—Ç—å—è 10.4: –í–ª–∞–¥–µ–ª–µ—Ü –Ω–æ–≤–æ—Å—Ç–Ω–æ–≥–æ –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä–∞ –æ–±—è–∑–∞–Ω –ø—Ä–æ–≤–µ—Ä—è—Ç—å –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –∑–Ω–∞—á–∏–º—ã—Ö —Å–≤–µ–¥–µ–Ω–∏–π –¥–æ –∏—Ö —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∏ –Ω–µ –¥–æ–ø—É—Å–∫–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–∞ –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è –∏–ª–∏ —Ñ–∞–ª—å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏."
            },
            {
                "code": "RF_149_MESSENGER_DUTIES",
                "type": "MANDATORY",
                "risk": "MEDIUM",
                "summary": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞—Å—Å—ã–ª–æ–∫ –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞—Ö.",
                "text": "–°—Ç–∞—Ç—å—è 10.1: –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä —Å–µ—Ä–≤–∏—Å–∞ –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –æ–±—è–∑–∞–Ω –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É –∑–∞–ø—Ä–µ—â–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é –≤–ª–∞—Å—Ç–µ–π."
            }
        ]
        
        for req in requirements:
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –¥–ª—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
            req_id = uuid.uuid4()

            conn.execute(text("""
                INSERT INTO legal_requirement (id, doc_id, req_code, requirement_type, risk_floor, summary, full_text)
                VALUES (:id, :doc_id, :code, :type, :risk, :summ, :text)
                ON CONFLICT (req_code) DO UPDATE SET full_text = EXCLUDED.full_text
            """), {
                "id": req_id,       # <--- –î–û–ë–ê–í–õ–ï–ù–û
                "doc_id": doc_id,
                "code": req["code"],
                "type": req["type"],
                "risk": req["risk"],
                "summ": req["summary"],
                "text": req["text"]
            })
        
        conn.commit()
        print("‚úÖ –§–ó-149 —É—Å–ø–µ—à–Ω–æ –æ—Ü–∏—Ñ—Ä–æ–≤–∞–Ω. –ê–≥–µ–Ω—Ç –∑–Ω–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –†—É–Ω–µ—Ç–∞.")

if __name__ == "__main__":
    seed_149_law()