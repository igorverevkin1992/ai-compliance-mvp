import os
from sqlalchemy import create_engine, text
import uuid

# –í—Å—Ç–∞–≤—å —Å–≤–æ—é —Å—Å—ã–ª–∫—É Supabase
DATABASE_URL = os.getenv("DATABASE_URL")
engine = create_engine(DATABASE_URL)

def seed_mat_dictionary():
    with engine.connect() as conn:
        print("ü§¨ –ó–∞–≥—Ä—É–∑–∫–∞ –°–ª–æ–≤–∞—Ä—è –º–∞—Ç–∞ (–õ–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –±–∞–∑–∞) –≤ —Å–∏—Å—Ç–µ–º—É...")
        
        # 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –≤ Python
        doc_id = uuid.uuid4()
        
        # 2. –ü–µ—Ä–µ–¥–∞–µ–º –µ–≥–æ –≤ –∑–∞–ø—Ä–æ—Å
        conn.execute(text("""
            INSERT INTO legal_doc (id, publisher, title, version) 
            VALUES (:id, '–†–§', '–ù–∞–∑–≤–∞–Ω–∏–µ...', '–≤–µ—Ä—Å–∏—è...')
        """), {"id": doc_id})
        
        # 2. –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–∞–≤–∏–ª–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–ª–æ–≤–∞—Ä—è
        requirements = [
            {
                "code": "DICT_MAT_ROOTS_OBSCENE",
                "type": "PROHIBITED",
                "risk": "CRITICAL",
                "summary": "¬´–ë–æ–ª—å—à–∞—è —á–µ—Ç–≤–µ—Ä–∫–∞¬ª –º–∞—Ç–µ—Ä–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π (–ê–±—Å–æ–ª—é—Ç–Ω—ã–π –∑–∞–ø—Ä–µ—Ç –≤ –°–ú–ò).",
                "text": "–°–æ–≥–ª–∞—Å–Ω–æ —Ä–∞–∑—ä—è—Å–Ω–µ–Ω–∏—è–º –†–æ—Å–∫–æ–º–Ω–∞–¥–∑–æ—Ä–∞ –∏ –ª–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–∞–∫—Ç–∏–∫–µ, –∫ –Ω–µ—Ü–µ–Ω–∑—É—Ä–Ω–æ–π –±—Ä–∞–Ω–∏ –æ—Ç–Ω–æ—Å—è—Ç—Å—è 4 –∫–æ—Ä–Ω—è: '—Ö*–π', '–ø*–∑–¥–∞', '–µ–±*—Ç—å', '–±–ª*–¥—å' –∏ –≤—Å–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç –Ω–∏—Ö —Å–ª–æ–≤–∞ (–≤–∫–ª—é—á–∞—è '–∞—Ö—É–µ—Ç—å', '–ø–∏–∑–¥–∞—Ç—ã–π', '–µ–±–∞–ª—å–Ω–∏–∫'). –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–ª–Ω–æ–µ –∑–∞–ø–∏–∫–∏–≤–∞–Ω–∏–µ (BLEEP) –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏–µ (CUT) –≤ —ç—Ñ–∏—Ä–Ω—ã—Ö –°–ú–ò."
            },
            {
                "code": "DICT_MAT_VULGAR_ABUSIVE",
                "type": "RESTRICTED",
                "risk": "MEDIUM",
                "summary": "–ì—Ä—É–±–∞—è, –Ω–æ —Ü–µ–Ω–∑—É—Ä–Ω–∞—è –±—Ä–∞–Ω—å (–°—É–∫–∞, –•–µ—Ä, –ú—É–¥–∞–∫ –∏ –¥—Ä.).",
                "text": "–°–ª–æ–≤–∞ '–°—É–∫–∞', '–•–µ—Ä' (–∫–∞–∫ –±—É–∫–≤–∞), '–ú—É–¥–∞–∫', '–ì–∞–Ω–¥–æ–Ω', '–ñ–æ–ø–∞', '–°—Ç–µ—Ä–≤–∞' –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ. –ù–µ —è–≤–ª—è—é—Ç—Å—è –Ω–µ—Ü–µ–Ω–∑—É—Ä–Ω–æ–π –±—Ä–∞–Ω—å—é —é—Ä–∏–¥–∏—á–µ—Å–∫–∏, –Ω–æ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ —Å–Ω–∏–∂–µ–Ω–Ω–æ–π/–±—Ä–∞–Ω–Ω–æ–π –ª–µ–∫—Å–∏–∫–µ. –î–æ–ø—É—Å—Ç–∏–º—ã –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ 16+/18+. –í –Ω–æ–≤–æ—Å—Ç—è—Ö –∏ –¥–µ—Ç—Å–∫–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç–µ —Ç—Ä–µ–±—É—é—Ç –º–æ–¥–µ—Ä–∞—Ü–∏–∏."
            },
            {
                "code": "DICT_MAT_SEXUAL_SLANG",
                "type": "RESTRICTED",
                "risk": "HIGH",
                "summary": "–°–ª–µ–Ω–≥–æ–≤—ã–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª–æ–≤—ã—Ö –æ—Ä–≥–∞–Ω–æ–≤ –∏ –∞–∫—Ç–æ–≤.",
                "text": "–°–ª–æ–≤–∞: '–ú–∞–Ω–¥–∞', '–ï–ª–¥–∞', '–î–∞–≤–∞–ª–∫–∞', '–í–¥—É—Ç—å', '–î—Ä–∞—Ç—å', '–¢—Ä–∞—Ö–∞—Ç—å'. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç—Ç–∏—Ö —Å–ª–æ–≤ –ø–æ–≤—ã—à–∞–µ—Ç –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥ –¥–æ 18+. –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –∏–ª–∏ –Ω–∞—Ç—É—Ä–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π - —Ä–∏—Å–∫ CRITICAL (–ø–æ—Ä–Ω–æ–≥—Ä–∞—Ñ–∏—è)."
            },
            {
                "code": "DICT_MAT_EUPHEMISMS",
                "type": "PERMITTED",
                "risk": "LOW",
                "summary": "–≠–≤—Ñ–µ–º–∏–∑–º—ã –∏ –∑–∞–º–µ–Ω—ã (–ë–ª–∏–Ω, –Å-–º–æ–µ, –•—Ä–µ–Ω).",
                "text": "–°–ª–æ–≤–∞-–∑–∞–º–µ–Ω–∏—Ç–µ–ª–∏ ('–ë–ª–∏–Ω', '–Å–ø–µ—Ä–Ω—ã–π —Ç–µ–∞—Ç—Ä', '–•—Ä–µ–Ω', '–§–∏–≥', '–Ø–ø–æ–Ω–∞ –º–∞—Ç—å') –¥–æ–ø—É—Å—Ç–∏–º—ã –≤ —ç—Ñ–∏—Ä–µ, –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —á—Ä–µ–∑–º–µ—Ä–Ω–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ. –†–µ–π—Ç–∏–Ω–≥ –æ–±—ã—á–Ω–æ 12+ –∏–ª–∏ 16+."
            }
        ]
        
        for req in requirements:
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –¥–ª—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
            req_id = uuid.uuid4()

            conn.execute(text("""
                INSERT INTO legal_requirement (id, doc_id, req_code, requirement_type, risk_floor, summary, full_text)
                VALUES (:id, :doc_id, :code, :type, :risk, :summ, :text)
                ON CONFLICT (req_code) DO UPDATE SET full_text = EXCLUDED.full_text
            """), {
                "id": req_id,       # <--- –î–û–ë–ê–í–õ–ï–ù–û
                "doc_id": doc_id,
                "code": req["code"],
                "type": req["type"],
                "risk": req["risk"],
                "summ": req["summary"],
                "text": req["text"]
            })
        
        conn.commit()
        print("‚úÖ –°–ª–æ–≤–∞—Ä—å –º–∞—Ç–∞ —É—Å–ø–µ—à–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω. –ê–≥–µ–Ω—Ç –Ω–∞—É—á–∏–ª—Å—è —Ä—É–≥–∞—Ç—å—Å—è (–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å).")

if __name__ == "__main__":
    seed_mat_dictionary()