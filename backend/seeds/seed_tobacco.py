import os
from sqlalchemy import create_engine, text
import uuid

# –í—Å—Ç–∞–≤—å —Å–≤–æ—é —Å—Å—ã–ª–∫—É Supabase
DATABASE_URL = os.getenv("DATABASE_URL")
engine = create_engine(DATABASE_URL)

def seed_tobacco_law():
    with engine.connect() as conn:
        print("üìñ –ó–∞–≥—Ä—É–∑–∫–∞ –§–ó-15 (–¢–∞–±–∞—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å) –≤ –±–∞–∑—É...")
        
        # 1. –°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç
        # 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –≤ Python
        doc_id = uuid.uuid4()
        
        # 2. –ü–µ—Ä–µ–¥–∞–µ–º –µ–≥–æ –≤ –∑–∞–ø—Ä–æ—Å
        conn.execute(text("""
            INSERT INTO legal_doc (id, publisher, title, version) 
            VALUES (:id, '–†–§', '–ù–∞–∑–≤–∞–Ω–∏–µ...', '–≤–µ—Ä—Å–∏—è...')
        """), {"id": doc_id})
        
        requirements = [
            {
                "code": "RF_TOBACCO_KIDS_001",
                "type": "PROHIBITED",
                "risk": "CRITICAL",
                "summary": "–ó–∞–ø—Ä–µ—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ç–∞–±–∞–∫–∞ –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ –¥–ª—è –¥–µ—Ç–µ–π.",
                "text": "–°—Ç–∞—Ç—å—è 16, —á.1, –ø.1, –ø–æ–¥–ø. '–¥': –ó–∞–ø—Ä–µ—â–∞–µ—Ç—Å—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ç–∞–±–∞—á–Ω—ã—Ö –∏–∑–¥–µ–ª–∏–π –∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —Ç–∞–±–∞–∫–∞ –≤–æ –≤–Ω–æ–≤—å —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –¥–ª—è –¥–µ—Ç–µ–π –∞—É–¥–∏–æ–≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è—Ö."
            },
            {
                "code": "RF_TOBACCO_ART_001",
                "type": "RESTRICTED",
                "risk": "MEDIUM",
                "summary": "–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ç–∞–±–∞–∫–∞ –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö –¥–æ–ø—É—Å—Ç–∏–º–∞ —Ç–æ–ª—å–∫–æ –∫–∞–∫ —Ö—É–¥. –∑–∞–º—ã—Å–µ–ª.",
                "text": "–°—Ç–∞—Ç—å—è 16, —á.1, –ø.1, –ø–æ–¥–ø. '–¥': –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ç–∞–±–∞–∫–∞ –≤–æ –≤–Ω–æ–≤—å —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è—Ö –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö –∑–∞–ø—Ä–µ—â–µ–Ω–∞, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ —ç—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–æ—Ç—ä–µ–º–ª–µ–º–æ–π —á–∞—Å—Ç—å—é —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–∞–º—ã—Å–ª–∞."
            },
            {
                "code": "RF_TOBACCO_SOCIAL_AD",
                "type": "MANDATORY",
                "risk": "HIGH",
                "summary": "–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –¥–∏—Å–∫–ª–µ–π–º–µ—Ä –ø—Ä–∏ –ø–æ–∫–∞–∑–µ —Ç–∞–±–∞–∫–∞.",
                "text": "–°—Ç–∞—Ç—å—è 16, —á.3: –ü—Ä–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ç–∞–±–∞—á–Ω—ã—Ö –∏–∑–¥–µ–ª–∏–π –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∫—É—Ä–µ–Ω–∏—è –≤–µ—â–∞—Ç–µ–ª—å –û–ë–Ø–ó–ê–ù –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—é —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Ä–µ–∫–ª–∞–º—ã –æ –≤—Ä–µ–¥–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —Ç–∞–±–∞–∫–∞ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –∏–ª–∏ –≤–æ –≤—Ä–µ–º—è –ø–æ–∫–∞–∑–∞."
            },
            {
                "code": "RF_TOBACCO_PROMO_001",
                "type": "PROHIBITED",
                "risk": "HIGH",
                "summary": "–ó–∞–ø—Ä–µ—Ç —Å–∫—Ä—ã—Ç–æ–π —Ä–µ–∫–ª–∞–º—ã —Ç–∞–±–∞–∫–∞ (—Å—Ç–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∂–∏).",
                "text": "–°—Ç–∞—Ç—å—è 16, —á.1: –ó–∞–ø—Ä–µ—â–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö –º–∞—Ä–æ–∫, –ª–æ–≥–æ—Ç–∏–ø–æ–≤ —Ç–∞–±–∞—á–Ω—ã—Ö –∏–∑–¥–µ–ª–∏–π –≤ —Ü–µ–ª—è—Ö —Ä–µ–∫–ª–∞–º—ã –∏–ª–∏ —Å—Ç–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è (—Å–∫—Ä—ã—Ç—ã–π –º–∞—Ä–∫–µ—Ç–∏–Ω–≥)."
            }
        ]
        
        for req in requirements:
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –¥–ª—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
            req_id = uuid.uuid4()

            conn.execute(text("""
                INSERT INTO legal_requirement (id, doc_id, req_code, requirement_type, risk_floor, summary, full_text)
                VALUES (:id, :doc_id, :code, :type, :risk, :summ, :text)
                ON CONFLICT (req_code) DO UPDATE SET full_text = EXCLUDED.full_text
            """), {
                "id": req_id,       # <--- –î–û–ë–ê–í–õ–ï–ù–û
                "doc_id": doc_id,
                "code": req["code"],
                "type": req["type"],
                "risk": req["risk"],
                "summ": req["summary"],
                "text": req["text"]
            })
        
        conn.commit()
        print("‚úÖ –§–ó-15 —É—Å–ø–µ—à–Ω–æ –æ—Ü–∏—Ñ—Ä–æ–≤–∞–Ω –∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–∞–∑—É –∑–Ω–∞–Ω–∏–π.")

if __name__ == "__main__":
    seed_tobacco_law()