import os
from sqlalchemy import create_engine, text
import uuid

# –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
DATABASE_URL = os.getenv("DATABASE_URL")
engine = create_engine(DATABASE_URL)

def seed_vk_rules():
    with engine.connect() as conn:
        print("üîµ –ó–∞–≥—Ä—É–∑–∫–∞ –ü—Ä–∞–≤–∏–ª VK –†–µ–∫–ª–∞–º—ã –≤ –±–∞–∑—É...")
        
        # 1. –°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç
        # Publisher = VK (—ç—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –ø–æ –ø—Ä–æ—Ñ–∏–ª—é "youtube/social")
        # 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –≤ Python
        doc_id = uuid.uuid4()
        
        # 2. –ü–µ—Ä–µ–¥–∞–µ–º –µ–≥–æ –≤ –∑–∞–ø—Ä–æ—Å
        conn.execute(text("""
            INSERT INTO legal_doc (id, publisher, title, version) 
            VALUES (:id, '–†–§', '–ù–∞–∑–≤–∞–Ω–∏–µ...', '–≤–µ—Ä—Å–∏—è...')
        """), {"id": doc_id})
        
        requirements = [
            {
                "code": "VK_IMG_BAD_QUALITY",
                "type": "RESTRICTED",
                "risk": "LOW",
                "summary": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞—á–µ—Å—Ç–≤—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Ç–µ–∫—Å—Ç—É (–Ω–µ –±–æ–ª–µ–µ 20%).",
                "text": "–ø. 2.2.1: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤—ã—Å–æ–∫–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞, –±–µ–∑ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤. –¢–µ–∫—Å—Ç –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–∞–Ω–∏–º–∞—Ç—å –±–æ–ª–µ–µ 20% –æ—Ç –æ–±—â–µ–π –ø–ª–æ—â–∞–¥–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–º—ã—Ç—ã–µ –∏–ª–∏ –ø–∏–∫—Å–µ–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ."
            },
            {
                "code": "VK_IMG_SEXUAL",
                "type": "PROHIBITED",
                "risk": "HIGH",
                "summary": "–ó–∞–ø—Ä–µ—Ç –Ω–∞ —Å–µ–∫—Å—É–∞–ª—å–Ω—ã–π –ø–æ–¥—Ç–µ–∫—Å—Ç –∏ –æ—Ç–∫—Ä–æ–≤–µ–Ω–Ω—ã–µ –ø–æ–∑—ã.",
                "text": "–ø. 2.2.2: –ù–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—Ç–∫—Ä–æ–≤–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Å–µ–∫—Å—É–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ç–µ–∫—Å—Ç–∞, –æ–±–Ω–∞–∂–µ–Ω–Ω—ã—Ö –ª—é–¥–µ–π, –∞–∫—Ü–µ–Ω—Ç–∞ –Ω–∞ –Ω–∏–∂–Ω–µ–º –±–µ–ª—å–µ, –ø—Ä–æ–≤–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∑, –∞ —Ç–∞–∫–∂–µ –º–µ—Ç–∞—Ñ–æ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑—Ä–µ–∑–∞–Ω–Ω–∞—è –∫–ª—É–±–Ω–∏–∫–∞ —Å —Å–æ–∫–æ–º)."
            },
            {
                "code": "VK_BAN_ALCO_TOBACCO",
                "type": "PROHIBITED",
                "risk": "CRITICAL",
                "summary": "–ü–æ–ª–Ω—ã–π –∑–∞–ø—Ä–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∞–ª–∫–æ–≥–æ–ª—è –∏ —Ç–∞–±–∞–∫–∞.",
                "text": "–ø. 2.2.3: –ù–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∞–ª–∫–æ–≥–æ–ª—å–Ω–æ–π –∏–ª–∏ —Ç–∞–±–∞—á–Ω–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏, –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ —Å—É–≤–µ–Ω–∏—Ä–æ–≤ –≤ –≤–∏–¥–µ –±—É—Ç—ã–ª–æ–∫/—Å–∏–≥–∞—Ä. –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: —Ç—Ä–µ–π–ª–µ—Ä—ã —Ñ–∏–ª—å–º–æ–≤ —Å –º–∞—Ä–∫–∏—Ä–æ–≤–∫–æ–π 18+."
            },
            {
                "code": "VK_IMG_SHOCK",
                "type": "PROHIBITED",
                "risk": "HIGH",
                "summary": "–ó–∞–ø—Ä–µ—Ç –Ω–∞ –ø—É–≥–∞—é—â–∏–µ –∏ –Ω–µ–ø—Ä–∏—è—Ç–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.",
                "text": "–ø. 2.2.4: –ù–µ –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è –ø—É–≥–∞—é—â–∏–µ, —ç—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–ø—Ä–∏–µ–º–ª–µ–º—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–±–æ–ª–µ–∑–Ω–∏, —É–≤–µ—á—å—è, –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ—ã, –æ—Ä—É–∂–∏–µ), –∞–∫—Ü–µ–Ω—Ç –Ω–∞ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –¥–µ—Ç–∞–ª—è—Ö."
            },
            {
                "code": "VK_IMG_BEFORE_AFTER",
                "type": "PROHIBITED",
                "risk": "MEDIUM",
                "summary": "–ó–∞–ø—Ä–µ—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è '–î–æ –∏ –ü–æ—Å–ª–µ' –¥–ª—è –º–µ–¥. —É—Å–ª—É–≥.",
                "text": "–ø. 2.2.6: –î–ª—è –∫–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–∏—Ö –∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä –∑–∞–ø—Ä–µ—â–µ–Ω–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ '–î–æ' –∏ '–ü–æ—Å–ª–µ'. –í–∏–¥–µ–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —É—Å–ª—É–≥ —Ç–∞–∫–∂–µ –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è."
            },
            {
                "code": "VK_FAKE_INTERFACE",
                "type": "PROHIBITED",
                "risk": "MEDIUM",
                "summary": "–ó–∞–ø—Ä–µ—Ç –∏–º–∏—Ç–∞—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–∫–Ω–æ–ø–∫–∏, –∫—Ä–µ—Å—Ç–∏–∫–∏).",
                "text": "–†–∞–∑–¥–µ–ª '–ò–º–∏—Ç–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞': –ö–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ –≤–≤–æ–¥–∏—Ç—å –≤ –∑–∞–±–ª—É–∂–¥–µ–Ω–∏–µ. –ó–∞–ø—Ä–µ—â–µ–Ω–æ —Ä–∏—Å–æ–≤–∞—Ç—å —Ñ–µ–π–∫–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏ 'Play', —á–µ–∫–±–æ–∫—Å—ã, –∫—Ä–µ—Å—Ç–∏–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è, —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ VK."
            },
            {
                "code": "VK_CAPSLOCK_BAN",
                "type": "RESTRICTED",
                "risk": "LOW",
                "summary": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ó–ê–ì–õ–ê–í–ù–´–• –ë–£–ö–í.",
                "text": "–†–∞–∑–¥–µ–ª '–ö–∞–ø—Å–ª–æ–∫': –ù–µ–ª—å–∑—è –ø–∏—Å–∞—Ç—å –≤–µ—Å—å —Ç–µ–∫—Å—Ç –∑–∞–≥–ª–∞–≤–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏ (–∫—Ä–æ–º–µ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä –∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±—Ä–µ–Ω–¥–æ–≤). –¢–µ–∫—Å—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –Ω–æ—Ä–º–∞–º —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞."
            },
            {
                "code": "VK_MAGIC_BAN",
                "type": "PROHIBITED",
                "risk": "HIGH",
                "summary": "–ó–∞–ø—Ä–µ—Ç —Ä–µ–∫–ª–∞–º—ã –º–∞–≥–∏–∏, —Ç–∞—Ä–æ –∏ —ç–∑–æ—Ç–µ—Ä–∏–∫–∏.",
                "text": "–†–∞–∑–¥–µ–ª '–ö–æ–ª–¥–æ–≤—Å—Ç–≤–æ, —Ç–∞—Ä–æ': –ó–∞–ø—Ä–µ—â–µ–Ω–æ —Ä–µ–∫–ª–∞–º–∏—Ä–æ–≤–∞—Ç—å —É—Å–ª—É–≥–∏ –º–∞–≥–æ–≤, —ç–∫—Å—Ç—Ä–∞—Å–µ–Ω—Å–æ–≤, —Ç–∞—Ä–æ–ª–æ–≥–æ–≤, —Ü–µ–ª–∏—Ç–µ–ª–µ–π. –î–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è/–π–æ–≥–∞ –±–µ–∑ –≥–∞—Ä–∞–Ω—Ç–∏–π —á—É–¥–∞."
            }
        ]
        
        for req in requirements:
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –¥–ª—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
            req_id = uuid.uuid4()

            conn.execute(text("""
                INSERT INTO legal_requirement (id, doc_id, req_code, requirement_type, risk_floor, summary, full_text)
                VALUES (:id, :doc_id, :code, :type, :risk, :summ, :text)
                ON CONFLICT (req_code) DO UPDATE SET full_text = EXCLUDED.full_text
            """), {
                "id": req_id,       # <--- –î–û–ë–ê–í–õ–ï–ù–û
                "doc_id": doc_id,
                "code": req["code"],
                "type": req["type"],
                "risk": req["risk"],
                "summ": req["summary"],
                "text": req["text"]
            })
        
        conn.commit()
        print("‚úÖ –ü—Ä–∞–≤–∏–ª–∞ VK —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã.")

if __name__ == "__main__":
    seed_vk_rules()